"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[5968],{2125:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>o,contentTitle:()=>s,default:()=>h,frontMatter:()=>t,metadata:()=>l,toc:()=>c});var i=r(4848),d=r(8453);const t={sidebar_position:5},s="\u6570\u636e\u5171\u4eab\u4e0e\u4e8b\u4ef6",l={id:"concepts/data_sharing_and_events",title:"\u6570\u636e\u5171\u4eab\u4e0e\u4e8b\u4ef6",description:"Ribir \u63d0\u4f9b\u4e86\u5728 Widget \u6811\u4e2d\u5171\u4eab\u6570\u636e\u548c\u5904\u7406 Widget \u95f4\u901a\u4fe1\u7684\u673a\u5236\u3002",source:"@site/i18n/zh/docusaurus-plugin-content-docs/current/concepts/data_sharing_and_events.md",sourceDirName:"concepts",slug:"/concepts/data_sharing_and_events",permalink:"/zh/docs/next/concepts/data_sharing_and_events",draft:!1,unlisted:!1,tags:[],version:"current",lastUpdatedBy:"RChangelog[bot]",lastUpdatedAt:1768791822e3,sidebarPosition:5,frontMatter:{sidebar_position:5},sidebar:"tutorialSidebar",previous:{title:"\u72b6\u6001\u7ba1\u7406",permalink:"/zh/docs/next/concepts/state_management"},next:{title:"\u5e03\u5c40\u7cfb\u7edf",permalink:"/zh/docs/next/concepts/layout"}},o={},c=[{value:"Provider\uff08\u6570\u636e\u5411\u4e0b\uff09",id:"provider\u6570\u636e\u5411\u4e0b",level:2},{value:"\u63d0\u4f9b\u6570\u636e",id:"\u63d0\u4f9b\u6570\u636e",level:3},{value:"\u4f7f\u7528 <code>providers</code> \u5b57\u6bb5\uff08\u63a8\u8350\uff09",id:"\u4f7f\u7528-providers-\u5b57\u6bb5\u63a8\u8350",level:4},{value:"\u4f7f\u7528 <code>Providers</code> Widget",id:"\u4f7f\u7528-providers-widget",level:4},{value:"\u6d88\u8d39\u6570\u636e",id:"\u6d88\u8d39\u6570\u636e",level:3},{value:"Provider \u7684\u7c7b\u578b",id:"provider-\u7684\u7c7b\u578b",level:3},{value:"Variant\uff08\u7075\u6d3b\u7684\u6570\u636e\u6d88\u8d39\uff09",id:"variant\u7075\u6d3b\u7684\u6570\u636e\u6d88\u8d39",level:2},{value:"\u4e0e\u76f4\u63a5 Provider \u8bbf\u95ee\u7684\u533a\u522b",id:"\u4e0e\u76f4\u63a5-provider-\u8bbf\u95ee\u7684\u533a\u522b",level:3},{value:"\u4f7f\u7528 Variant \u7684\u4f18\u52bf",id:"\u4f7f\u7528-variant-\u7684\u4f18\u52bf",level:3},{value:"\u57fa\u672c\u7528\u6cd5",id:"\u57fa\u672c\u7528\u6cd5",level:3},{value:"\u4f7f\u7528\u56de\u9000",id:"\u4f7f\u7528\u56de\u9000",level:3},{value:"\u6620\u5c04\u503c",id:"\u6620\u5c04\u503c",level:3},{value:"\u7279\u6b8a\u989c\u8272\u52a9\u624b",id:"\u7279\u6b8a\u989c\u8272\u52a9\u624b",level:3},{value:"\u81ea\u5b9a\u4e49\u4e8b\u4ef6\uff08\u6d88\u606f\u5411\u4e0a\uff09",id:"\u81ea\u5b9a\u4e49\u4e8b\u4ef6\u6d88\u606f\u5411\u4e0a",level:2},{value:"\u5b9a\u4e49\u4e8b\u4ef6",id:"\u5b9a\u4e49\u4e8b\u4ef6",level:3},{value:"\u5206\u53d1\u4e8b\u4ef6",id:"\u5206\u53d1\u4e8b\u4ef6",level:3},{value:"\u76d1\u542c\u4e8b\u4ef6",id:"\u76d1\u542c\u4e8b\u4ef6",level:3},{value:"\u76d1\u542c\u4efb\u4f55\u81ea\u5b9a\u4e49\u4e8b\u4ef6",id:"\u76d1\u542c\u4efb\u4f55\u81ea\u5b9a\u4e49\u4e8b\u4ef6",level:3}];function a(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"\u6570\u636e\u5171\u4eab\u4e0e\u4e8b\u4ef6",children:"\u6570\u636e\u5171\u4eab\u4e0e\u4e8b\u4ef6"}),"\n",(0,i.jsx)(n.p,{children:"Ribir \u63d0\u4f9b\u4e86\u5728 Widget \u6811\u4e2d\u5171\u4eab\u6570\u636e\u548c\u5904\u7406 Widget \u95f4\u901a\u4fe1\u7684\u673a\u5236\u3002"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Provider"}),": \u5411\u4e0b\u4f20\u9012\u6570\u636e\uff08\u7236\u7ea7 -> \u5b50\u7ea7/\u540e\u4ee3\uff09\u3002"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u81ea\u5b9a\u4e49\u4e8b\u4ef6"}),": \u5411\u4e0a\u4f20\u9012\u6d88\u606f\uff08\u5b50\u7ea7 -> \u7236\u7ea7/\u7956\u5148\uff09\u3002"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"provider\u6570\u636e\u5411\u4e0b",children:"Provider\uff08\u6570\u636e\u5411\u4e0b\uff09"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"Provider"})," \u7cfb\u7edf\u8ba9\u60a8\u80fd\u591f\u4e0e\u6240\u6709\u540e\u4ee3 Widget \u5171\u4eab\u6570\u636e\uff0c\u800c\u65e0\u9700\u901a\u8fc7\u5c42\u7ea7\u7ed3\u6784\u7684\u6bcf\u4e00\u5c42\u4f20\u9012 props\u3002"]}),"\n",(0,i.jsx)(n.h3,{id:"\u63d0\u4f9b\u6570\u636e",children:"\u63d0\u4f9b\u6570\u636e"}),"\n",(0,i.jsxs)(n.p,{children:["\u60a8\u53ef\u4ee5\u4f7f\u7528 ",(0,i.jsx)(n.code,{children:"Providers"})," Widget \u6216 ",(0,i.jsx)(n.code,{children:"providers!"})," \u5b8f\uff08\u6216 ",(0,i.jsx)(n.code,{children:"providers"})," \u5c5e\u6027\uff09\u6765\u63d0\u4f9b\u6570\u636e\u3002"]}),"\n",(0,i.jsxs)(n.h4,{id:"\u4f7f\u7528-providers-\u5b57\u6bb5\u63a8\u8350",children:["\u4f7f\u7528 ",(0,i.jsx)(n.code,{children:"providers"})," \u5b57\u6bb5\uff08\u63a8\u8350\uff09"]}),"\n",(0,i.jsxs)(n.p,{children:["Ribir \u4e2d\u7684\u5927\u591a\u6570 Widget \u58f0\u660e\u65f6\u90fd\u652f\u6301\u5185\u7f6e\u5c5e\u6027\uff08\u53c2\u7167 ",(0,i.jsx)(n.a,{href:"/zh/docs/next/concepts/built_in_attributes_and_fat_obj",children:"\u5185\u7f6e\u5c5e\u6027\u548c FatObj"}),"\uff09 ",(0,i.jsx)(n.code,{children:"providers"})," \u3002\u8fd9\u4f1a\u6bd4\u7528 ",(0,i.jsx)(n.code,{children:"Providers"})," Widget \u5305\u88c5\u66f4\u7b80\u6d01\u3002"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-rust",metastring:"ignore",children:'use ribir::prelude::*;\n\nstruct Theme {\n    primary: Color,\n}\n\nfn app() -> Widget<\'static> {\n    fn_widget! {\n        let theme = Stateful::new(Theme { primary: Color::RED });\n\n        @Column {\n            // \u5728 Widget \u4e0a\u76f4\u63a5\u63d0\u4f9b\u6570\u636e\n            providers: [Provider::new(theme)],\n            @Text { text: "Hello" }\n        }\n    }.into_widget()\n}\n'})}),"\n",(0,i.jsxs)(n.h4,{id:"\u4f7f\u7528-providers-widget",children:["\u4f7f\u7528 ",(0,i.jsx)(n.code,{children:"Providers"})," Widget"]}),"\n",(0,i.jsxs)(n.p,{children:["\u6216\u8005\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528 ",(0,i.jsx)(n.code,{children:"Providers"})," Widget \u5305\u88c5\u5b50\u6811\u3002"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-rust",metastring:"ignore",children:"use ribir::prelude::*;\n\nstruct UserInfo {\n    name: String,\n}\n\nfn app() -> Widget<'static> {\n    fn_widget! {\n        let user = Stateful::new(UserInfo { name: \"Alice\".to_string() });\n\n        @Providers {\n            providers: [\n                // \u5171\u4eab\u4e00\u4e2a\u72b6\u6001\u5199\u5165\u5668\uff0c\u5141\u8bb8\u540e\u4ee3\u8bfb\u53d6\u548c\u4fee\u6539 'user'\n                // \u7b2c\u4e8c\u4e2a\u53c2\u6570 `None` \u610f\u5473\u7740\u6211\u4eec\u624b\u52a8\u7ba1\u7406\u810f\u901a\u77e5\u6216\u4e0d\u9700\u8981\u5e03\u5c40\u66f4\u65b0\n                Provider::writer(user, None)\n            ],\n            @Column {\n                @ChildWidget {}\n            }\n        }\n    }.into_widget()\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\u6d88\u8d39\u6570\u636e",children:"\u6d88\u8d39\u6570\u636e"}),"\n",(0,i.jsxs)(n.p,{children:["\u540e\u4ee3 Widget \u53ef\u4ee5\u4f7f\u7528 ",(0,i.jsx)(n.code,{children:"Provider::of"}),"\uff08\u8bfb\u53d6\uff09\u6216 ",(0,i.jsx)(n.code,{children:"Provider::write_of"}),"\uff08\u5199\u5165\uff09\u8bbf\u95ee\u63d0\u4f9b\u7684\u6570\u636e\u3002"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-rust",metastring:"ignore",children:'fn child_widget() -> Widget<\'static> {\n    fn_widget! {\n        @Text {\n            // \u4ece\u6700\u8fd1\u7684 UserInfo \u63d0\u4f9b\u8005\u8bfb\u53d6\n            text: pipe! {\n                let user = Provider::of::<UserInfo>(BuildCtx::get())?;\n                format!("Hello, {}", user.name)\n            }\n        }\n    }.into_widget()\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"provider-\u7684\u7c7b\u578b",children:"Provider \u7684\u7c7b\u578b"}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"\u65b9\u6cd5"}),(0,i.jsx)(n.th,{children:"\u63cf\u8ff0"}),(0,i.jsx)(n.th,{children:"\u8bbf\u95ee"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"Provider::new(value)"})}),(0,i.jsx)(n.td,{children:"\u5171\u4eab\u4e00\u4e2a\u4e0d\u53ef\u53d8\u503c\u3002"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"Provider::of"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"Provider::reader(state)"})}),(0,i.jsx)(n.td,{children:"\u5171\u4eab\u4e00\u4e2a\u53ea\u8bfb\u72b6\u6001\u3002"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"Provider::of"}),", ",(0,i.jsx)(n.code,{children:"Provider::state_of"}),"\uff08\u8bfb\u53d6\u5668\uff09"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"Provider::writer(state, phase)"})}),(0,i.jsxs)(n.td,{children:["\u5171\u4eab\u4e00\u4e2a\u53ef\u53d8\u72b6\u6001\u3002",(0,i.jsx)(n.code,{children:"phase"})," \u63a7\u5236\u5e03\u5c40\u810f\u6807\u8bb0\u3002"]}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"Provider::of"}),", ",(0,i.jsx)(n.code,{children:"Provider::write_of"}),", ",(0,i.jsx)(n.code,{children:"Provider::state_of"}),"\uff08\u5199\u5165\u5668\uff09"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"Provider::watcher(state)"})}),(0,i.jsx)(n.td,{children:"\u5171\u4eab\u4e00\u4e2a\u76d1\u89c6\u5668\uff08\u53ef\u89c2\u5bdf\u5bf9\u8c61\uff09\u3002"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"Provider::of"}),", ",(0,i.jsx)(n.code,{children:"Provider::state_of"}),"\uff08\u76d1\u89c6\u5668\uff09"]})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"variant\u7075\u6d3b\u7684\u6570\u636e\u6d88\u8d39",children:"Variant\uff08\u7075\u6d3b\u7684\u6570\u636e\u6d88\u8d39\uff09"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"Variant"})," \u63d0\u4f9b\u4e86\u5bf9 ",(0,i.jsx)(n.code,{children:"Provider"})," \u7684\u5feb\u6377\u8bbf\u95ee\uff0c\u80fd\u591f\u81ea\u52a8\u5904\u7406\u9759\u6001\u503c\u548c\u52a8\u6001\u72b6\u6001\uff08\u76d1\u89c6\u5668\uff09\u3002\u5b83\u901a\u8fc7\u7edf\u4e00\u7684 API \u7b80\u5316\u4e86\u8fd9\u4e24\u79cd\u60c5\u51b5\u4e0b\u63d0\u4f9b\u6570\u636e\u7684\u6d88\u8d39\u3002"]}),"\n",(0,i.jsx)(n.h3,{id:"\u4e0e\u76f4\u63a5-provider-\u8bbf\u95ee\u7684\u533a\u522b",children:"\u4e0e\u76f4\u63a5 Provider \u8bbf\u95ee\u7684\u533a\u522b"}),"\n",(0,i.jsxs)(n.p,{children:["\u76f4\u63a5\u4f7f\u7528 ",(0,i.jsx)(n.code,{children:"Provider"})," \u65f6\uff0c\u60a8\u9700\u8981\u77e5\u9053\u6570\u636e\u662f\uff1a"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u9759\u6001\u503c\uff08",(0,i.jsx)(n.code,{children:"Provider::of"}),"\uff09"]}),"\n",(0,i.jsxs)(n.li,{children:["\u72b6\u6001\u8bfb\u53d6\u5668/\u5199\u5165\u5668\uff08",(0,i.jsx)(n.code,{children:"Provider::state_of"}),"\uff09"]}),"\n",(0,i.jsxs)(n.li,{children:["\u76d1\u89c6\u5668\uff08",(0,i.jsx)(n.code,{children:"Provider::state_of"})," \u4e0e\u76d1\u89c6\u5668\u7c7b\u578b\uff09"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"Variant"})," \u4f1a\u81ea\u52a8\u68c0\u6d4b\u63d0\u4f9b\u8005\u7c7b\u578b\u5e76\u4e3a\u60a8\u5904\u7406\u54cd\u5e94\u6027\uff1a"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u9996\u5148\u68c0\u67e5",(0,i.jsx)(n.strong,{children:"\u76d1\u89c6\u5668\u63d0\u4f9b\u8005"}),"\uff08\u54cd\u5e94\u5f0f\uff09"]}),"\n",(0,i.jsxs)(n.li,{children:["\u56de\u9000\u5230",(0,i.jsx)(n.strong,{children:"\u503c\u63d0\u4f9b\u8005"}),"\uff08\u9759\u6001\uff09"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"\u4f7f\u7528-variant-\u7684\u4f18\u52bf",children:"\u4f7f\u7528 Variant \u7684\u4f18\u52bf"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u7edf\u4e00\u7684 API"}),"\uff1a\u4e00\u4e2a\u65b9\u6cd5\uff08",(0,i.jsx)(n.code,{children:"Variant::new"}),"\uff09\u540c\u65f6\u9002\u7528\u4e8e\u9759\u6001\u548c\u52a8\u6001\u63d0\u4f9b\u8005"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u81ea\u52a8\u54cd\u5e94\u6027"}),"\uff1a\u5982\u679c\u63d0\u4f9b\u8005\u662f\u4e00\u4e2a\u89c2\u5bdf\u5668\uff08Watcher\uff09\uff0c\u5f53\u503c\u53d1\u751f\u53d8\u5316\u65f6\uff0c\u60a8\u7684\u7ec4\u4ef6\u4f1a\u81ea\u52a8\u66f4\u65b0"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u4fbf\u6377\u7684\u6620\u5c04"}),"\uff1a\u4f7f\u7528 ",(0,i.jsx)(n.code,{children:"map()"})," \u5728\u4fdd\u6301\u54cd\u5e94\u6027\u7684\u540c\u65f6\u8f6c\u6362\u503c"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"\u5185\u7f6e\u56de\u9000\u673a\u5236"}),"\uff1a\u901a\u8fc7 ",(0,i.jsx)(n.code,{children:"new_or()"}),"\u3001",(0,i.jsx)(n.code,{children:"new_or_default()"})," \u6216 ",(0,i.jsx)(n.code,{children:"new_or_else()"})," \u63d0\u4f9b\u9ed8\u8ba4\u503c"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"\u57fa\u672c\u7528\u6cd5",children:"\u57fa\u672c\u7528\u6cd5"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-rust",metastring:"ignore",children:"use ribir::prelude::*;\n\nfn themed_box() -> Widget<'static> {\n    fn_widget! {\n        // \u81ea\u52a8\u4ece\u63d0\u4f9b\u8005\u83b7\u53d6\u989c\u8272\uff08\u9759\u6001\u6216\u53cd\u5e94\u6027\uff09\n        let color = Variant::<Color>::new(BuildCtx::get()).unwrap();\n\n        @Container {\n            size: Size::new(100., 100.),\n            // \u5982\u679c\u7956\u5148\u63d0\u4f9b Color \u7684\u5199\u5165\u5668\uff0c\u8fd9\u5c06\u5bf9\u53d8\u5316\u505a\u51fa\u53cd\u5e94\n            background: color,\n        }\n    }.into_widget()\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\u4f7f\u7528\u56de\u9000",children:"\u4f7f\u7528\u56de\u9000"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-rust",metastring:"ignore",children:'fn themed_text() -> Widget<\'static> {\n    fn_widget! {\n        // \u5982\u679c\u53ef\u7528\u5219\u4f7f\u7528\u4e3b\u9898\u989c\u8272\uff0c\u5426\u5219\u4f7f\u7528\u7ea2\u8272\n        let color = Variant::<Color>::new_or(\n            BuildCtx::get(),\n            Color::from_rgb(255, 0, 0)\n        );\n\n        @Text {\n            text: "Hello",\n            foreground: color,\n        }\n    }.into_widget()\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u6620\u5c04\u503c",children:"\u6620\u5c04\u503c"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-rust",metastring:"ignore",children:"fn subtle_background() -> Widget<'static> {\n    fn_widget! {\n        let color = Variant::<Color>::new_or_default(BuildCtx::get());\n\n        // \u8f6c\u6362\u989c\u8272\u7684\u540c\u65f6\u4fdd\u6301\u53cd\u5e94\u6027\n        let subtle_color = color.map(|c| c.with_alpha(0.1));\n\n        @Container {\n            background: subtle_color,\n            // ... \u5176\u4ed6\u5c5e\u6027\n        }\n    }.into_widget()\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\u7279\u6b8a\u989c\u8272\u52a9\u624b",children:"\u7279\u6b8a\u989c\u8272\u52a9\u624b"}),"\n",(0,i.jsxs)(n.p,{children:["\u5bf9\u4e8e ",(0,i.jsx)(n.code,{children:"Variant<Color>"}),"\uff0c\u6709\u7528\u4e8e\u6839\u636e\u4e3b\u9898\u7684\u4eae\u5ea6\u7ec4\u8bbf\u95ee\u4e0d\u540c\u8272\u8c03\u7684\u5185\u7f6e\u65b9\u6cd5\uff1a"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-rust",metastring:"ignore",children:"let primary = Variant::<Color>::new(BuildCtx::get()).unwrap();\n\n// \u57fa\u4e8e\u4e3b\u9898\u7684\u4eae\u5ea6\u7ec4\u83b7\u53d6\u4e0d\u540c\u8272\u8c03\nlet base = primary.into_base_color(BuildCtx::get());\nlet container = primary.into_container_color(BuildCtx::get());\nlet on_color = primary.on_this_color(BuildCtx::get());\nlet on_container = primary.on_this_container_color(BuildCtx::get());\n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u8fd9\u4e9b\u65b9\u6cd5\u5728\u81ea\u52a8\u8c03\u6574\u4eae\u5ea6\u7684\u540c\u65f6\uff0c\u80fd\u4fdd\u6301\u5bf9\u6e90 ",(0,i.jsx)(n.code,{children:"Variant"})," \u53d8\u5316\u7684\u54cd\u5e94\uff0c\u8ba9\u60a8\u53ef\u4ee5\u8f7b\u677e\u6784\u5efa\u51fa\u98ce\u683c\u4e00\u81f4\u3001\u9002\u914d\u4e3b\u9898\u7684 UI\u3002"]}),"\n",(0,i.jsx)(n.h2,{id:"\u81ea\u5b9a\u4e49\u4e8b\u4ef6\u6d88\u606f\u5411\u4e0a",children:"\u81ea\u5b9a\u4e49\u4e8b\u4ef6\uff08\u6d88\u606f\u5411\u4e0a\uff09"}),"\n",(0,i.jsx)(n.p,{children:"\u81ea\u5b9a\u4e49\u4e8b\u4ef6\u5141\u8bb8 Widget \u8c03\u5ea6\u4e00\u4e2a\u4e8b\u4ef6\uff0c\u8be5\u4e8b\u4ef6\u5411\u4e0a\u5192\u6ce1\u5230 Widget \u6811\u3002\u7956\u5148\u53ef\u4ee5\u76d1\u542c\u8fd9\u4e9b\u4e8b\u4ef6\uff0c\u800c\u65e0\u9700\u663e\u5f0f\u5411\u4e0b\u4f20\u9012\u56de\u8c03\u3002"}),"\n",(0,i.jsx)(n.h3,{id:"\u5b9a\u4e49\u4e8b\u4ef6",children:"\u5b9a\u4e49\u4e8b\u4ef6"}),"\n",(0,i.jsx)(n.p,{children:"\u5b9a\u4e49\u4e00\u4e2a\u7ed3\u6784\u6765\u4fdd\u5b58\u60a8\u7684\u4e8b\u4ef6\u6570\u636e\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-rust",metastring:"ignore",children:"struct MyCustomEvent {\n    message: String,\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\u5206\u53d1\u4e8b\u4ef6",children:"\u5206\u53d1\u4e8b\u4ef6"}),"\n",(0,i.jsxs)(n.p,{children:["\u4f7f\u7528 ",(0,i.jsx)(n.code,{children:"ctx.window().bubble_custom_event(...)"})," \u4ece Widget \u5206\u53d1\u4e8b\u4ef6\u3002"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-rust",metastring:"ignore",children:'fn child_emitter() -> Widget<\'static> {\n    fn_widget! {\n        @Button {\n            on_tap: move |e| {\n                let event = MyCustomEvent { message: "Clicked!".to_string() };\n                // \u4ece\u6b64 Widget \u5192\u6ce1\u4e8b\u4ef6 (e.id)\n                e.window().bubble_custom_event(e.id, event);\n            },\n            // \u6309\u94ae\u7684\u5185\u5bb9\uff08TemplateChild\uff09\uff0c\u8fd9\u91cc\u76f4\u63a5\u4f20\u5165\u5b57\u7b26\u4e32\u4f5c\u4e3a\u6587\u672c\n            @{ "Emit Event" }\n        }\n    }.into_widget()\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u76d1\u542c\u4e8b\u4ef6",children:"\u76d1\u542c\u4e8b\u4ef6"}),"\n",(0,i.jsxs)(n.p,{children:["\u7956\u5148\u53ef\u4ee5\u4f7f\u7528 ",(0,i.jsx)(n.code,{children:"on_custom"})," \u76d1\u542c\u7279\u5b9a\u7684\u81ea\u5b9a\u4e49\u4e8b\u4ef6\u3002"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-rust",metastring:"ignore",children:'fn parent_listener() -> Widget<\'static> {\n    fn_widget! {\n        @Column {\n            // \u76d1\u542c\u4ece Widget \u5192\u6ce1\u7684 MyCustomEvent\n            on_custom: |e: &mut CustomEvent<MyCustomEvent>| {\n                println!("Received: {}", e.message);\n\n                // \u505c\u6b62\u4e8b\u4ef6\u8fdb\u4e00\u6b65\u5411\u4e0a\u5192\u6ce1\n                e.stop_propagation();\n            },\n            @child_emitter {}\n        }\n    }.into_widget()\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u76d1\u542c\u4efb\u4f55\u81ea\u5b9a\u4e49\u4e8b\u4ef6",children:"\u76d1\u542c\u4efb\u4f55\u81ea\u5b9a\u4e49\u4e8b\u4ef6"}),"\n",(0,i.jsxs)(n.p,{children:["\u60a8\u8fd8\u53ef\u4ee5\u4f7f\u7528 ",(0,i.jsx)(n.code,{children:"on_raw_custom"})," \u76d1\u542c\u6240\u6709\u5192\u6ce1\u7684\u81ea\u5b9a\u4e49\u4e8b\u4ef6\uff0c\u4f46\u60a8\u5c06\u6536\u5230\u4e00\u4e2a ",(0,i.jsx)(n.code,{children:"RawCustomEvent"}),"\uff0c\u5982\u679c\u9700\u8981\uff0c\u60a8\u9700\u8981\u624b\u52a8\u5411\u4e0b\u8f6c\u6362\u3002"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-rust",metastring:"ignore",children:'@Container {\n    on_raw_custom: |e: &mut RawCustomEvent| {\n        println!("Something happened!");\n    }\n}\n'})})]})}function h(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>s,x:()=>l});var i=r(6540);const d={},t=i.createContext(d);function s(e){const n=i.useContext(t);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:s(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);