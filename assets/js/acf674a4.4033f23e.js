"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[7609],{7532:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>d,default:()=>h,frontMatter:()=>r,metadata:()=>c,toc:()=>l});var t=i(4848),s=i(8453);const r={},d="Widget System",c={id:"guide/core_concepts/widgets_composition",title:"Widget System",description:"Ribir's widget system is built on three core traits: Render, Compose, and ComposeChild. Understanding these traits is key to creating custom widgets and understanding how Ribir constructs the UI tree.",source:"@site/docs/guide/core_concepts/widgets_composition.md",sourceDirName:"guide/core_concepts",slug:"/guide/core_concepts/widgets_composition",permalink:"/docs/next/guide/core_concepts/widgets_composition",draft:!1,unlisted:!1,tags:[],version:"current",lastUpdatedBy:"RChangelog[bot]",lastUpdatedAt:1766826148e3,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"State Management",permalink:"/docs/next/guide/core_concepts/state_management"}},o={},l=[{value:"1. Render vs Compose",id:"1-render-vs-compose",level:2},{value:"The <code>Render</code> Trait",id:"the-render-trait",level:3},{value:"The <code>Compose</code> Trait",id:"the-compose-trait",level:3},{value:"2. ComposeChild &amp; Child Structure",id:"2-composechild--child-structure",level:2},{value:"The <code>ComposeChild</code> Trait",id:"the-composechild-trait",level:3},{value:"SingleChild vs MultiChild",id:"singlechild-vs-multichild",level:3}];function a(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"widget-system",children:"Widget System"}),"\n",(0,t.jsxs)(n.p,{children:["Ribir's widget system is built on three core traits: ",(0,t.jsx)(n.code,{children:"Render"}),", ",(0,t.jsx)(n.code,{children:"Compose"}),", and ",(0,t.jsx)(n.code,{children:"ComposeChild"}),". Understanding these traits is key to creating custom widgets and understanding how Ribir constructs the UI tree."]}),"\n",(0,t.jsx)(n.h2,{id:"1-render-vs-compose",children:"1. Render vs Compose"}),"\n",(0,t.jsxs)(n.h3,{id:"the-render-trait",children:["The ",(0,t.jsx)(n.code,{children:"Render"})," Trait"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"Render"}),' is the low-level interface for widgets that actually draw something on the screen or manage layout directly. If a widget is a "leaf" node that paints pixels (like ',(0,t.jsx)(n.code,{children:"Text"})," or ",(0,t.jsx)(n.code,{children:"Rectangle"}),") or a container that calculates the positions of its children (like ",(0,t.jsx)(n.code,{children:"Row"})," or ",(0,t.jsx)(n.code,{children:"Column"}),"), it implements ",(0,t.jsx)(n.code,{children:"Render"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["Key responsibilities of ",(0,t.jsx)(n.code,{children:"Render"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Layout"}),": Calculating its own size and the position of its children (",(0,t.jsx)(n.code,{children:"perform_layout"}),")."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Painting"}),": Drawing content to the canvas (",(0,t.jsx)(n.code,{children:"paint"}),")."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Hit Testing"}),": Determining if a point interacts with the widget (",(0,t.jsx)(n.code,{children:"hit_test"}),")."]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-rust",metastring:"ignore",children:"// Simplified concept of a Render widget\nimpl Render for MyCustomPainter {\n    fn perform_layout(&self, clamp: BoxClamp, ctx: &mut LayoutCtx) -> Size {\n        // Calculate size...\n        Size::new(100., 100.)\n    }\n\n    fn paint(&self, ctx: &mut PaintingCtx) {\n        // Draw something...\n        let rect = Rect::from_size(ctx.box_size().unwrap());\n        ctx.painter().rect(&rect).fill();\n    }\n}\n"})}),"\n",(0,t.jsxs)(n.h3,{id:"the-compose-trait",children:["The ",(0,t.jsx)(n.code,{children:"Compose"})," Trait"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"Compose"}),' is for high-level widgets that are built by combining other widgets. They don\'t draw anything themselves; they just expand into a tree of other widgets. This is similar to a "Component" in React or Vue.']}),"\n",(0,t.jsxs)(n.p,{children:["Most application-level widgets (like a ",(0,t.jsx)(n.code,{children:"UserProfile"})," or ",(0,t.jsx)(n.code,{children:"LoginForm"}),") implement ",(0,t.jsx)(n.code,{children:"Compose"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-rust",metastring:"no_run",children:'use ribir::prelude::*;\n\n#[derive(Declare)]\npub struct WelcomeCard;\n\nimpl Compose for WelcomeCard {\n    fn compose(this: impl StateWriter<Value = Self>) -> Widget<\'static> {\n        fn_widget! {\n            @Column {\n                @Text { text: "Welcome!" }\n                @Button { @{ "Click me" } }\n            }\n        }.into_widget()\n    }\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"2-composechild--child-structure",children:"2. ComposeChild & Child Structure"}),"\n",(0,t.jsx)(n.p,{children:"Ribir uses a strictly typed parent-child relationship system. Not all widgets can accept children, and some accept specific types of children."}),"\n",(0,t.jsxs)(n.h3,{id:"the-composechild-trait",children:["The ",(0,t.jsx)(n.code,{children:"ComposeChild"})," Trait"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"ComposeChild"})," is a variation of ",(0,t.jsx)(n.code,{children:"Compose"})," for widgets that wrap or modify a child widget. It defines how the parent and child are combined."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-rust",metastring:"ignore",children:"pub trait ComposeChild<'c>: Sized {\n    type Child;\n    fn compose_child(this: impl StateWriter<Value = Self>, child: Self::Child) -> Widget<'c>;\n}\n"})}),"\n",(0,t.jsx)(n.h3,{id:"singlechild-vs-multichild",children:"SingleChild vs MultiChild"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"SingleChild"})," and ",(0,t.jsx)(n.code,{children:"MultiChild"})," traits are used to identify the type of widget that accepts the number of children, usually used for layout."]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"SingleChild"}),": Widgets that accept exactly one child."]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Example: ",(0,t.jsx)(n.code,{children:"SizedBox"}),", ",(0,t.jsx)(n.code,{children:"Padding"}),", ",(0,t.jsx)(n.code,{children:"Container"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["In DSL: ",(0,t.jsx)(n.code,{children:"@Container { @Text { ... } }"})]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"MultiChild"}),": Widgets that accept a list of children."]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Example: ",(0,t.jsx)(n.code,{children:"Row"}),", ",(0,t.jsx)(n.code,{children:"Column"}),", ",(0,t.jsx)(n.code,{children:"Stack"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["In DSL:\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-rust",metastring:"ignore",children:"@Column {\n    @Text { ... }\n    @Text { ... }\n}\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Usually you just need to specify it when defining the type:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-rust",metastring:"ignore",children:"#[derive(SingleChild, Declare)]\npub struct Container;\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-rust",metastring:"ignore",children:"#[derive(MultiChild, Declare)]\npub struct Row;\n"})})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>d,x:()=>c});var t=i(6540);const s={},r=t.createContext(s);function d(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:d(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);